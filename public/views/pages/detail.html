<form role="form" ng-submit="updateAPI()">
  <div class="row top-buffer" ng-init="getSingleAPI()">
    <div class="col-md-12">
      <div class="pull-left owapi-breadcrumb">
        <a href="#/apis">APIs</a> /
        <a href="#/apis/{{ api.name }}">{{ api.name }}</a></li>
      </div>
      <div class="pull-right">
        <button class="btn btn-primary text-right btn-sm" ng-click="updateAPI()">Save changes</button>
        <button class="btn btn-success text-right btn-sm" ng-click="getSingleAPI()">Refresh</button>
      </div>
      <div class="clearfix"></div>
    </div>
  </div>
  <hr>

  <div class="row top-buffer">
    <div class="col-md-12">
      <textarea class="form-control info-text" rows="2" ng-model="api.info"></textarea>
    </div>
  </div>

  <div class="row top-buffer">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <strong>Resources</strong>
        </div>
        <table class="table table-responsive table-hover">
          <tr ng-repeat="(resourceKey, resourceValue) in api.resources">
            <td class="col-md-4">
              <a href="#/apis/{{ api.name }}" ng-click="setSelectedResource(resourceKey)">
                {{api.name}}/{{ resourceKey }}
              </a>
            </td>
            <td class="col-md-4"></td>
            <td class="col-md-4 text-right">
              <a href="#/apis/{{ api.name }}" ng-click="removeResourceFromAPI(resourceKey)">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
              </a>
            </td>
          </tr>
          <tr>
            <td class="col-md-4">
              {{api.name}}/ <input type="text" ng-model="newResourceName">
            </td>
            <td class="col-md-4">
            </td>
            <td class="col-md-4 text-right">
              <a href="#/apis/{{ api.name }}" ng-click="addResourceToAPI(api)">
                <span class="glyphicon glyphicon-plus"></span>
              </a>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>

  <div class="row top-buffer" ng-show="selectedResource">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <strong>Schema</strong> of /{{ selectedResource }}
        </div>
        <table class="table table-responsive">
          <tr ng-repeat="(propertyKey, propertyValue) in api.resources[selectedResource]">
            <td>{{ propertyKey}}</td>
            <td>
              <select class="form-control" ng-model="api.resources[selectedResource][propertyKey]">
                <option>String</option>
                <option>Number</option>
                <option>Date</option>
                <option>ObjectId</option>
              </select>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td class="col-md-4">
              <input type="text" ng-model="newPropertyName">
            </td>
            <td class="col-md-4"></td>
            <td class="col-md-4 text-right">
              <a href="#/apis/{{ api.name }}" ng-click="addPropertyToResource(newPropertyName, selectedResource)">
                <span class="glyphicon glyphicon-plus"></span>
              </a>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>

  <div class="row top-buffer">
    <div class="col-md-12">
      <div class="panel panel-danger">
        <div class="panel-heading">
          Danger Zone
        </div>
        <div class="panel-body">
          <a href="#/apis/"  class="btn btn-danger" ng-click="deleteAPI()">
            Delete API
          </a>
        </div>
      </div>
    </div>
  </div>

</form>
